{{!--
   --
   --
   --
   --
   --
   --         WARNING: Editing this file may prevent future updates via schematics.
   --                  To maintain easy upgradability, do not edit this file.
   --
   --
   --
   --
   --
   --}}
{{#*inline "trackingTags"}}{{#each tags}}{{#if (equal type 'tracking')}}{{name}},{{/if}}{{/each}}{{/inline}}
{{#*inline "portalConfigJson"}}
  {
    linkRoot: '{{getConfig "linkRoot"}}',
    locales: '{{getConfig "locales"}}',
    currentLinkUUID: '{{getConfig "currentLinkUUID"}}',
    cspNonce: '{{getConfig "cspNonce"}}',
    version: '6',
    apiRoot: '{{getConfig "apiRoot"}}',
    staticResourcesRoot: '{{getConfig "staticResourcesRoot"}}/static/items',
    portalName: '{{contextItemName}}',
    pageName: '{{name}}',
    designmode: '{{getConfig "designmode"}}',
    currentLink: '{{ datasources.currentLink.uuid }}',
    locale: '{{locale}}',
    isAdmin: '{{getConfig "isAdmin"}}',
    isManager: '{{getConfig "isManager"}}',
    userId: '{{getConfig "authenticatedUserName"}}'
  }
{{/inline}}
<!DOCTYPE html>
<html dir="{{dir}}" lang="{{locale}}" data-tracking="{{> trackingTags}}">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{preferences.title.value}}</title>
    {{#if preferences.faviconPath.value}}
      <link rel="icon" type="image/x-icon" href="{{getConfig "staticResourcesRoot"}}/static/items/{{preferences.faviconPath.value}}/favicon.ico">
    {{/if}}
    <script>
      var BB = {
        prefs: {
          maxInactivityDurationInSeconds: {{preferences.maxInactivityDurationInSeconds.value}}
        },
        config: {{> portalConfigJson}}
      };
      BB.config.cx = {{{ getConfig "experience.configuration" }}};
      if (!BB.config.cx.landingPageUrl) {
        BB.config.cx.landingPageUrl = '{{ getConfig "defaultLandingPage" }}';
      }
      if (!BB.config.cx.loginPageUrl) {
        BB.config.cx.loginPageUrl = '{{ getConfig "loginPage" }}';
      }
      if (!BB.config.cx.authUrl) {
        BB.config.cx.authUrl = '{{ getConfig "authUrl" }}';
      }

      (function(){
        var localeDirs = {{localeDirs}};
        var realAppendChild = document.head.appendChild;
        document.head.appendChild = function() {
          if (arguments.length && arguments[0].tagName === 'SCRIPT') {
            var src = arguments[0].getAttribute('src');
            if (src && !src.startsWith("http://") && !src.startsWith('https://') && !src.startsWith('/')) {
              src = BB.config.staticResourcesRoot + '/employee-web-app-page/' + (localeDirs['{{locale}}'] || '') + src;
              arguments[0].setAttribute('src', src);
            }
          }
          realAppendChild.apply(document.head, arguments);
        };
      })();

    </script>
    {{styles}}
  </head>
  <body>
    <app-root></app-root>
    {{scripts}}
  </body>
</html>
